         47920339 function calls (47665488 primitive calls) in 268.845 seconds

   Ordered by: cumulative time
   List reduced from 8886 to 50 due to restriction <50>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    27/26    0.214    0.008  339.125   13.043 /usr/lib/python3.13/threading.py:641(wait)
        1    0.000    0.000  249.082  249.082 /workspace/run_simulation.py:26(run_profiled_simulation)
    28256    2.441    0.000  241.598    0.009 /workspace/farm/core/agent.py:957(act)
    84381    0.738    0.000  205.686    0.002 /workspace/farm/core/agent.py:498(create_decision_state)
    84381    0.446    0.000  203.759    0.002 /workspace/farm/core/environment.py:1314(observe)
    84381    5.833    0.000  203.310    0.002 /workspace/farm/core/environment.py:1463(_get_observation)
        1    0.348    0.348  159.073  159.073 /workspace/farm/core/simulation.py:195(run_simulation)
    84381    8.624    0.000  154.980    0.002 /workspace/farm/core/observations.py:1411(perceive_world)
    28127    0.792    0.000   76.846    0.003 /workspace/farm/core/agent.py:773(_select_action_with_curriculum)
       35    0.001    0.000   66.693    1.906 /home/ubuntu/.local/lib/python3.13/site-packages/torch/_ops.py:369(fallthrough)
    84381    8.857    0.000   47.299    0.001 /workspace/farm/core/observations.py:1375(update_known_empty)
   168762    0.457    0.000   38.507    0.000 /workspace/farm/core/observations.py:1521(tensor)
   168762    7.453    0.000   38.049    0.000 /workspace/farm/core/observations.py:1153(_build_dense_tensor)
   253143    4.900    0.000   32.400    0.000 /workspace/farm/core/channels.py:851(process)
   337524    0.718    0.000   32.257    0.000 /workspace/farm/core/channels.py:288(_safe_store_sparse_grid)
   337524   16.298    0.000   31.306    0.000 /workspace/farm/core/observations.py:1059(_store_sparse_grid)
    91055    1.389    0.000   28.554    0.000 /home/ubuntu/.local/lib/python3.13/site-packages/torch/utils/_contextlib.py:117(decorate_context)
    84381    1.215    0.000   25.128    0.000 /workspace/farm/core/channels.py:932(process)
    91055   17.544    0.000   23.732    0.000 /workspace/farm/core/observations.py:142(apply_to_dense)
   164944   20.195    0.000   20.904    0.000 /workspace/farm/core/environment.py:73(bilinear_distribute_value)
    84381    0.326    0.000   16.803    0.000 /workspace/farm/core/channels.py:652(process)
    84381    5.662    0.000   16.671    0.000 /workspace/farm/core/observations.py:717(make_disk_mask)
    84381    0.213    0.000   16.417    0.000 /workspace/farm/core/channels.py:226(_safe_store_sparse_point)
    84381    1.402    0.000   16.162    0.000 /workspace/farm/core/observations.py:901(_store_sparse_point)
   180885    8.945    0.000   13.635    0.000 /workspace/farm/core/spatial/index.py:910(get_nearby)
    84381    1.625    0.000   12.789    0.000 /workspace/farm/core/observations.py:1342(decay_dynamics)
    84381    0.460    0.000   12.126    0.000 /workspace/farm/core/observations.py:129(add_point)
    84381    1.378    0.000   11.666    0.000 /workspace/farm/core/observations.py:118(add_points)
       30    0.001    0.000   11.176    0.373 /home/ubuntu/.local/lib/python3.13/site-packages/tianshou/policy/modelfree/dqn.py:41(__init__)
       30    0.005    0.000   11.172    0.372 /home/ubuntu/.local/lib/python3.13/site-packages/tianshou/policy/base.py:62(__init__)
       30    0.002    0.000   11.154    0.372 /home/ubuntu/.local/lib/python3.13/site-packages/tianshou/policy/base.py:403(_compile)
        3    0.000    0.000   11.143    3.714 /home/ubuntu/.local/lib/python3.13/site-packages/numba/core/dispatcher.py:344(_compile_for_args)
     41/3    0.002    0.000   11.069    3.690 /home/ubuntu/.local/lib/python3.13/site-packages/numba/core/dispatcher.py:862(compile)
     14/3    0.000    0.000   11.068    3.689 /home/ubuntu/.local/lib/python3.13/site-packages/numba/core/dispatcher.py:79(compile)
     14/3    0.000    0.000   11.068    3.689 /home/ubuntu/.local/lib/python3.13/site-packages/numba/core/dispatcher.py:86(_compile_cached)
     14/3    0.001    0.000   11.068    3.689 /home/ubuntu/.local/lib/python3.13/site-packages/numba/core/dispatcher.py:101(_compile_core)
     14/3    0.000    0.000   11.066    3.689 /home/ubuntu/.local/lib/python3.13/site-packages/numba/core/compiler.py:713(compile_extra)
 1070/330    0.011    0.000   10.434    0.032 /home/ubuntu/.local/lib/python3.13/site-packages/numba/core/compiler_lock.py:32(_acquire_compile_lock)
     25/3    0.000    0.000   10.315    3.438 /home/ubuntu/.local/lib/python3.13/site-packages/numba/core/compiler.py:433(compile_extra)
     25/3    0.000    0.000   10.306    3.435 /home/ubuntu/.local/lib/python3.13/site-packages/numba/core/compiler.py:500(_compile_bytecode)
     25/3    0.004    0.000   10.306    3.435 /home/ubuntu/.local/lib/python3.13/site-packages/numba/core/compiler.py:456(_compile_core)
     25/3    0.004    0.000   10.299    3.433 /home/ubuntu/.local/lib/python3.13/site-packages/numba/core/compiler_machinery.py:342(run)
   675/81    0.059    0.000   10.291    0.127 /home/ubuntu/.local/lib/python3.13/site-packages/numba/core/compiler_machinery.py:267(_runPass)
 2025/243    0.006    0.000   10.256    0.042 /home/ubuntu/.local/lib/python3.13/site-packages/numba/core/compiler_machinery.py:271(check)
    18188    0.101    0.000    9.930    0.001 /home/ubuntu/.local/lib/python3.13/site-packages/structlog/_native.py:142(meth)
       20    0.000    0.000    9.839    0.492 /home/ubuntu/.local/lib/python3.13/site-packages/torch/_ops.py:307(py_impl)
    18188    0.119    0.000    9.828    0.001 /home/ubuntu/.local/lib/python3.13/site-packages/structlog/_base.py:192(_proxy_to_logger)
   337524    0.642    0.000    9.439    0.000 /workspace/farm/core/channels.py:311(_safe_decay_sparse_channel)
      985    0.013    0.000    9.207    0.009 /workspace/farm/database/database.py:692(_execute_in_transaction)
    25/13    0.007    0.000    9.055    0.697 /home/ubuntu/.local/lib/python3.13/site-packages/numba/core/typed_passes.py:439(run_pass)


